<!doctype html>
<html lang="en" data-bs-theme="dark">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Mora Idur More Jabe</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      body {
        background-color: #1a1d20;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        user-select: none;
        margin: 0;
        padding: 0;
      }

      body.inverted-inputs {
        cursor: none !important;
      }

      /* 3D CHUNKY UI STYLES */
      .card,
      .survey-card,
      .captcha-card {
        border: 4px solid #333 !important;
        box-shadow:
          10px 10px 0px #000000,
          inset 2px 2px 0px rgba(255, 255, 255, 0.1) !important;
        transform: translate(-5px, -5px);
      }

      .digital-display {
        border: 4px solid #111 !important;
        box-shadow: inset 5px 5px 15px rgba(0, 0, 0, 0.9) !important;
        background: #050505 !important;
        color: #00ff41;
        font-family: "Courier New", Courier, monospace;
        font-size: 3rem;
        font-weight: bold;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        letter-spacing: 5px;
        margin-bottom: 20px;
        position: relative;
      }

      .btn {
        position: relative;
        border: 2px solid rgba(0, 0, 0, 0.5) !important;
        box-shadow: 0px 6px 0px rgba(0, 0, 0, 0.6) !important;
        transition: all 0.1s !important;
        margin-bottom: 6px !important;
      }
      .btn:active {
        top: 6px;
        box-shadow: 0px 0px 0px rgba(0, 0, 0, 0.6) !important;
      }

      .progress {
        border: 2px solid #555;
        background: #222;
        box-shadow: inset 2px 2px 5px #000;
        border-radius: 10px;
      }
      .progress-bar {
        background-image: linear-gradient(
          to bottom,
          rgba(255, 255, 255, 0.3) 0%,
          rgba(255, 255, 255, 0) 50%,
          rgba(0, 0, 0, 0.1) 100%
        );
      }

      #phantom-cursor {
        position: fixed;
        top: 0;
        left: 0;
        width: 25px;
        height: 25px;
        background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="red" stroke="white" stroke-width="2"><path d="M5.5 3.21l10.8 5.43-4.5 1.5 4.3 6.67-2.3 1.54-4.5-6.83-2.9 3.9V3.21z"/></svg>');
        pointer-events: none;
        z-index: 10000;
        display: none;
      }

      .app-layer {
        display: none;
        width: 100%;
        height: 100vh;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .active-layer {
        display: flex;
      }

      /* LAYER 1 STYLES */
      #layer-1 {
        position: relative;
        overflow: hidden;
        color: white;
        cursor: pointer;
      }
      #boot-gif2 {
        width: 100%;
        height: 350px;
        object-fit: contain;
        border-top: 0px solid #444;
        display: block;
        opacity: 0.8;
      }
      .layer-1-content {
        position: relative;
        z-index: 2;
        text-align: center;
      }
      .click-instruction {
        background: rgba(0, 0, 0, 0.5);
        padding: 20px;
        border-radius: 10px;
        border: 1px solid #00ff41;
        box-shadow: 0 0 20px #00ff41;
        margin-top: 20px;
        animation: pulse 2s infinite;
      }
      @keyframes pulse {
        0% {
          opacity: 0.8;
        }
        50% {
          opacity: 1;
        }
        100% {
          opacity: 0.8;
        }
      }

      /* LAYER 2 & 3 STYLES */
      .survey-card {
        background: #222;
        padding: 40px;
        width: 90%;
        max-width: 500px;
      }
      .card {
        width: 100%;
        max-width: 600px;
        overflow: hidden;
        animation: subtle-shake 4s infinite;
        display: flex;
        flex-direction: column;
      }

      @keyframes subtle-shake {
        0% {
          transform: translate(0, 0);
        }
        2% {
          transform: translate(1px, 1px);
        }
        4% {
          transform: translate(-1px, -1px);
        }
        6% {
          transform: translate(0, 0);
        }
        100% {
          transform: translate(0, 0);
        }
      }
      @keyframes violent-shake {
        0% {
          transform: translate(0, 0) rotate(0deg);
          background-color: #1a1d20;
        }
        25% {
          transform: translate(5px, 5px) rotate(5deg);
          background-color: #ff0000;
        } /* Flash Red */
        50% {
          transform: translate(-5px, -5px) rotate(-5deg);
          background-color: #3e06f6;
        } /* Flash Black */
        75% {
          transform: translate(5px, -5px) rotate(5deg);
          background-color: #0f7300;
        } /* Flash Green */
        100% {
          transform: translate(-5px, 5px) rotate(-5deg);
          background-color: #f3f4f5;
        }
      }

      .active-segment {
        border-bottom: 4px solid #0d6efd;
        color: #fff;
      }
      .btn-xl {
        padding: 15px 20px;
        font-size: 1.2rem;
        font-weight: bold;
        width: 100%;
        border-radius: 0;
        text-transform: uppercase;
      }

      .loading-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: rgba(0, 0, 0, 0.8);
        display: none;
        justify-content: center;
        align-items: center;
        color: white;
        font-family: monospace;
        z-index: 10;
        border-radius: 10px;
      }

      .btn-runaway {
        position: absolute;
        transition:
          top 0.3s ease,
          left 0.3s ease;
        z-index: 999;
      }
      .card-body {
        position: relative;
        overflow: hidden;
        padding-bottom: 0;
      }
      .danger-zone {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }
      .btn-forbidden {
        font-size: 10px;
        letter-spacing: 1px;
        background: #300;
        color: red;
        border: 1px dashed red;
      }

      .crank-flash {
        animation: flash 0.1s;
        background-color: #fff !important;
      }
      @keyframes flash {
        0% {
          background: #fff;
        }
        100% {
          background: transparent;
        }
      }

      /* CAPTCHA STYLES */
      .captcha-overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        z-index: 5000;
        display: none;
        flex-direction: column;
        align-items: center;
        justify-content: center;
      }
      .captcha-card {
        background: #222;
        padding: 20px;
        max-width: 400px;
        width: 95%;
        text-align: center;
      }
      .captcha-header {
        background: #0d6efd;
        color: white;
        padding: 10px;
        font-weight: bold;
        margin-bottom: 10px;
        font-family: sans-serif;
      }
      .captcha-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 5px;
        margin-bottom: 15px;
      }
      .captcha-img {
        width: 100%;
        height: 80px;
        object-fit: cover;
        border: 2px solid transparent;
        cursor: pointer;
        opacity: 0.8;
      }
      .captcha-img.selected {
        border: 3px solid #00ff41;
        opacity: 1;
        transform: scale(0.95);
      }

      /* BSOD STYLES */
      #bsod-layer {
        background-color: #0078d7;
        z-index: 9999;
        cursor: none;
        padding: 10% 15%;
        margin: 0;
        width: 100%;
        height: 100%;
        color: white;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        display: none; /* Hidden by default */
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
      }
      /* This class forces it to show when JS adds it */
      #bsod-layer.active-layer {
        display: flex !important;
      }

      .sad-face {
        font-size: 120px;
        margin-bottom: 30px;
      }
      .bsod-title {
        font-size: 28px;
        margin-bottom: 30px;
        line-height: 1.4;
      }
      .bsod-percent {
        font-size: 24px;
        margin-bottom: 30px;
      }
      .bsod-details {
        display: flex;
        align-items: center;
        gap: 20px;
        font-size: 14px;
      }
      .qr-code {
        background: white;
        padding: 4px;
        width: 100px;
        height: 100px;
      }
      .stop-code {
        line-height: 1.6;
      }

      .lifeless-msg {
        font-size: 5rem;
        color: #000;
        font-weight: bold;
        text-transform: uppercase;
        animation: flash 0.2s infinite;
        display: none;
        margin-top: 20px;
      }

      /* TEXT ANIMATION */
      .delta-fade {
        display: inline-block;
        opacity: 0;
        transform: translateY(0);
        transition: all 0.5s ease-out;
        margin-right: 10px;
        font-family: monospace;
        font-size: 1.5rem;
      }
      .delta-visible {
        opacity: 1;
        transform: translateY(-10px);
      }

      /* FOOTER & DIGITAL CLOCK */
      .footer-row {
        display: flex;
        height: 100px;
        width: 100%;
      }

      .footer-clock-container {
        width: 50%;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        background: #000;
        border-top: 2px solid #444;
        color: #00ff41;
        font-family: "Courier New", Courier, monospace;
      }
      .footer-label {
        font-size: 0.9rem;
        opacity: 0.8;
        margin-bottom: 5px;
        text-transform: uppercase;
        letter-spacing: 1px;
      }
      .footer-time {
        font-size: 1.8rem;
        font-weight: bold;
        letter-spacing: 2px;
        text-shadow: 0 0 10px rgba(0, 255, 65, 0.5);
      }

      /* MOBILE */
      @media (max-width: 768px) {
        .card,
        .survey-card,
        #layer-1 {
          width: 95% !important;
          max-width: none !important;
          margin: 10px auto;
        }
        .display-1 {
          font-size: 3rem;
        }
        .digital-display {
          font-size: 2rem;
          padding: 10px;
        }
        h1#countdown-display {
          font-size: 2rem !important;
        }
        .btn-xl {
          padding: 10px;
          font-size: 1rem;
        }
        #boot-gif2 {
          height: 100%;
          object-fit: cover;
        }
        .btn-runaway {
          position: static !important;
        }
        .footer-time {
          font-size: 1.2rem;
        }
      }
    </style>
  </head>
  <body>
    <div id="phantom-cursor"></div>

    <div id="layer-1" class="app-layer active-layer" onclick="initAudioAndGo()">
      <div class="layer-1-content">
        <h2>ùê∞ùê®ùê¶ùê© ùê∞ùê®ùê¶ùê© üóø</h2>
        <h6><strike> BCF25 </strike> &nbsp; BCF26 or whatever</h6>
        <br />
        <img
          id="boot-gif2"
          src="https://media2.giphy.com/media/v1.Y2lkPTc5MGI3NjExajZrYzYyZ21sdnlsejB5aXFhNWk4aHFrN200NDZwdWtycDRwYmZvcSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/XYZ9OXuxBNvPA8APXs/giphy.gif"
          alt="System Activity"
        />
        <div class="click-instruction">
          <h3><i class="fa-solid fa-power-off"></i> Lesgooüí©</h3>
        </div>
      </div>
    </div>

    <div id="layer-2" class="app-layer">
      <div class="survey-card animate__animated animate__fadeInUp">
        <h3 class="text-white mb-4">‡¶Ö‡¶ô‡ßç‡¶ó‡ßÄ‡¶ï‡¶æ‡¶∞‡¶®‡¶æ‡¶Æ‡¶æ</h3>
        <div class="mb-4">
          <label class="form-label text-muted"
            >Type <br />
            "I will never do irony again in my whole 'VOET' life. From now on,
            ami ja bolibo shotto bolibo, shotto chara ar kichu bolibo na."
            <br />
            exactly: <br />
            (or suffer idc)</label
          >
          <input
            type="text"
            class="form-control bg-dark text-white border-secondary"
            id="typing-challenge"
            oninput="checkSpelling(this)"
            autocomplete="off"
            onpaste="return false;"
          />
          <div
            class="form-text text-danger"
            id="error-msg"
            style="display: none; font-size: 0.8rem"
          >
            *‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶ø‡¶ü‡¶ø‡¶§‡ßá ‡¶™‡¶°‡¶º‡¶ø‡¶∏, ‡¶¨‡¶æ‡¶®‡¶æ‡¶® ‡¶ú‡¶æ‡¶®‡¶ø‡¶∏ (‡¶ú‡¶æ‡¶®‡ßá‡¶®) ‡¶®‡¶æ?* RESTARTING.
          </div>
        </div>
        <div class="mb-4 form-check">
          <input type="checkbox" class="form-check-input" id="terms-check" />
          <label class="form-check-label text-muted" for="terms-check"
            >I agree to the ü§è<span style="text-decoration: line-through"
              >Soul Binding</span
            >ü§≤ Terms & Conditions</label
          >
        </div>
        <button class="btn btn-success w-100" onclick="validateLayer2()">
          Confirm & Verify (‡¶∏‡¶Æ‡ßç‡¶Æ‡ßÅ‡¶ñ‡¶™‡¶æ‡¶®‡ßá ‡¶è‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶ö‡¶≤‡ßã)
        </button>
        <div class="mb-4">
          <label class="form-label text-muted"
            ><br />‡¶¨‡¶ø.‡¶¶‡ßç‡¶∞. <br />
            <br />
            <h6 style="color: rgb(239, 89, 89)">
              1. ‡¶è‡¶á ‡¶ß‡¶æ‡¶™‡¶ü‡¶ø ‡¶∏‡ßç‡¶ï‡¶ø‡¶™ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶á‡¶≤‡ßá "Enter" key ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶®
            </h6>
            2.‡¶π‡¶≤‡ßÅ‡¶¶ Button ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶≤‡ßá Random ‡¶Æ‡¶æ‡¶® Generate ‡¶π‡¶¨‡ßá<br />3.‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ ‡¶Æ‡¶ø‡¶≤‡ßá
            ‡¶ó‡ßá‡¶≤‡ßá Commit ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá<br />4.‡¶Æ‡¶æ‡¶ù‡ßá ‡¶Æ‡¶æ‡¶ù‡ßá CRANK
            ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá Health ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶® <br />
          </label>
        </div>
      </div>
    </div>

    <div id="layer-3" class="app-layer">
      <div id="captcha-overlay" class="captcha-overlay">
        <div class="captcha-card animate__animated animate__bounceIn">
          <div class="captcha-header">
            Select all images with<br />
            <h2 style="margin: 0">PILLOWS</h2>
          </div>
          <div class="captcha-grid" id="captcha-grid"></div>
          <button class="btn btn-primary w-100" onclick="verifyCaptcha()">
            VERIFY
          </button>
        </div>
      </div>

      <div class="card animate__animated" id="mainCard">
        <div
          class="card-header bg-primary text-white d-flex justify-content-between align-items-center"
        >
          <span>ALARM CLOCK (‡¶Ö‡ßç‡¶Ø‡¶æ‡¶≤‡¶æ‡¶∞‡ßç‡¶Æ ‡¶ò‡¶°‡¶º‡¶ø)</span
          ><span class="badge bg-danger">1.676767</span>
        </div>

        <div class="card-body p-4">
          <div class="mb-3" id="power-section">
            <label class="text-muted small">Battery Health</label>
            <div class="progress" style="height: 25px; border: 1px solid #555">
              <div
                id="battery-bar"
                class="progress-bar bg-success"
                role="progressbar"
                style="width: 100%"
              >
                100%
              </div>
            </div>
            <button
              id="crank-btn"
              class="btn btn-sm btn-outline-secondary w-100 mt-1"
              onclick="chargeBattery()"
            >
              <i class="fa-solid fa-rotate-right"></i> CRANK (‡¶π‡ßá‡¶≤‡¶• ‡¶¨‡¶æ‡¶°‡¶º‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
              ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶®)
            </button>
          </div>

          <div class="alert alert-info p-2 small" id="status-text">
            ‡¶∏‡¶¨ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶ö‡ßç‡¶õ‡¶ø üòè...
            <br />
            Phase 1. Hours (‡¶ò‡¶£‡ßç‡¶ü‡¶æ)...
          </div>

          <div class="digital-display">
            <div class="loading-overlay" id="loader">
              <div class="spinner-border text-primary"></div>
            </div>
            <span id="seg-hh" class="active-segment">--</span> :
            <span id="seg-mm">--</span> : <span id="seg-ss">--</span>
            <span id="seg-ap" style="font-size: 2rem">--</span>
          </div>

          <div
            id="countdown-panel"
            style="display: none; text-align: center; margin-top: 20px"
          >
            <h6 class="text-muted">‡¶ï‡ßã‡¶•‡¶æ‡¶Ø‡¶º ‡¶è‡¶≤‡¶æ‡¶Æ ‡¶Ü‡¶Æ‡¶ø?</h6>
            <h6 class="text-muted">‡¶ï‡¶ø‡¶∏‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ù‡ßá, ‡¶ï‡ßá‡¶Æ‡¶® ‡¶ï‡¶∞‡ßá?</h6>
            <h6 class="text-muted">‡¶è‡¶§ ‡¶Ü‡¶Å‡¶ß‡¶æ‡¶∞, ‡¶Ü‡¶Å‡¶ß‡¶æ‡¶∞ ‡¶ö‡¶æ‡¶∞‡¶ø‡¶™‡¶æ‡¶∂‡ßá</h6>
            <h4 class="text-muted">TIME UNTIL DETONATION:</h4>
            <h1
              id="countdown-display"
              style="
                font-size: 3rem;
                color: yellow;
                font-family: &quot;Courier New&quot;;
              "
            >
              00:00:00
            </h1>
            <div class="alert alert-warning mt-2" id="alarm-status-msg">
              <i class="fa-solid fa-triangle-exclamation fa-beat"></i> ALARM
              ARMED
            </div>

            <div
              id="disable-btn-container"
              style="display: none; margin-top: 20px"
            >
              <h1 class="text-success display-1 fw-bold">UNLOCKED</h1>
              <button
                class="btn btn-danger btn-lg w-100 mt-2"
                onclick="location.reload()"
              >
                DISABLE ALARM (‡¶¨‡¶®‡ßç‡¶ß ‡¶ï‡¶∞‡ßÅ‡¶®)
              </button>
            </div>
          </div>

          <div class="danger-zone" id="controls-1">
            <button
              class="btn btn-forbidden btn-sm"
              onclick="triggerSuffering()"
            >
              DO NOT PRESS <br />
              (‡¶¶‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡ßá ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶¨‡ßá‡¶® ‡¶®‡¶æ)
            </button>
            <div class="text-muted text-end">
              <span id="buffer-delta" class="delta-fade"></span>
              BUFFER (‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶Æ‡¶æ‡¶®):
              <strong id="buffer-val" class="text-white fs-4">0</strong>
            </div>
          </div>

          <div class="row g-2" id="controls-2">
            <div class="col-8">
              <button
                class="btn btn-outline-warning btn-xl"
                onclick="requestInteger()"
              >
                ‡¶¨‡¶æ‡¶¨‡¶æ &nbsp; <strike> ‡¶¶‡¶∂ ‡¶ü‡¶æ‡¶ï‡¶æ </strike> &nbsp;&nbsp; ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∏‡¶Æ‡¶Ø‡¶º
                ‡¶¶‡¶æ‡¶ì
              </button>
            </div>
            <div class="col-4">
              <button
                class="btn btn-primary btn-xl"
                onclick="commitTransaction()"
              >
                Commit (‡¶è‡¶ó‡¶ø‡¶Ø‡¶º‡ßá ‡¶Ø‡¶æ‡¶ì)
              </button>
            </div>
          </div>
        </div>

        <div class="footer-row">
          <img
            id="boot-gif"
            style="
              width: 50%;
              height: 100%;
              object-fit: cover;
              border-top: 2px solid #444;
              border-right: 2px solid #444;
            "
            src="https://media0.giphy.com/media/v1.Y2lkPTc5MGI3NjExZWZhbzlxaHg3Zml5Z2RtYjRzejJhMmc3aW8wamR0aGNhMjV2ZTAxaSZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Zz9YbblScCLxRi9PBj/giphy.gif"
            alt="System Activity"
          />

          <div class="footer-clock-container">
            <div class="footer-label">‡¶è‡¶ñ‡¶® ‡¶∏‡¶Æ‡¶Ø‡¶º</div>
            <div id="footer-digital-time" class="footer-time">--:--:-- --</div>
          </div>
        </div>
      </div>
    </div>

    <div id="bsod-layer" class="app-layer">
      <div id="bsod-content">
        <div class="sad-face">:(</div>
        <div class="bsod-title">
          Your PC ran into a problem and needs to restart. We're just collecting
          some error info, and then we'll restart for you.
        </div>
        <div class="bsod-percent">
          <span id="bsod-progress">0%</span> complete
        </div>
        <div class="bsod-details">
          <img
            class="qr-code"
            src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.youtube.com/watch?v=dQw4w9WgXcQ"
            alt="QR"
          />
          <div class="stop-code">
            For more information about this issue and possible fixes, visit
            https://www.windows.com/stopcode<br /><br />
            If you call a support person, give them this info:<br />
            Stop code: CRITICAL_PROCESS_DIED
          </div>
        </div>
      </div>
      <div id="lifeless-text" class="lifeless-msg">
        &nbsp;&nbsp;LIFELESS ‡¶ï‡ßã‡¶•‡¶æ‡¶ï‡¶æ‡¶∞&nbsp;&nbsp;
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script>
      // === AUDIO ENGINE ===
      let audioCtx;
      function initAudio() {
        if (!audioCtx)
          audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        if (audioCtx.state === "suspended") audioCtx.resume();
      }

      function playClickSound() {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.frequency.setValueAtTime(800, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(
          300,
          audioCtx.currentTime + 0.1,
        );
        gain.gain.setValueAtTime(1.0, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(
          0.01,
          audioCtx.currentTime + 0.1,
        );
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.1);
      }

      function playErrorSound() {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = "sawtooth";
        osc.frequency.setValueAtTime(150, audioCtx.currentTime);
        osc.frequency.linearRampToValueAtTime(100, audioCtx.currentTime + 0.3);
        gain.gain.setValueAtTime(1.0, audioCtx.currentTime);
        gain.gain.linearRampToValueAtTime(0, audioCtx.currentTime + 0.3);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.3);
      }

      function playCrankSound() {
        if (!audioCtx) return;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = "square";
        osc.frequency.setValueAtTime(200, audioCtx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(
          50,
          audioCtx.currentTime + 0.05,
        );
        gain.gain.setValueAtTime(1.0, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(
          0.001,
          audioCtx.currentTime + 0.05,
        );
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.05);
      }

      function playBSODSound() {
        if (!audioCtx) return;
        const duration = 15;
        const bufferSize = audioCtx.sampleRate * duration;
        const buffer = audioCtx.createBuffer(
          1,
          bufferSize,
          audioCtx.sampleRate,
        );
        const data = buffer.getChannelData(0);
        for (let i = 0; i < bufferSize; i++) {
          data[i] = (Math.random() * 2 - 1) * 0.5;
        }
        const noise = audioCtx.createBufferSource();
        noise.buffer = buffer;
        const gain = audioCtx.createGain();
        gain.gain.setValueAtTime(0.8, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(
          0.01,
          audioCtx.currentTime + duration,
        );
        noise.connect(gain);
        gain.connect(audioCtx.destination);
        noise.start();
      }

      function playAlarmSound() {
        if (!audioCtx) return;
        let volumeMultiplier = 0.5;
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.type = "sawtooth";
        osc.frequency.setValueAtTime(440, audioCtx.currentTime);
        osc.frequency.linearRampToValueAtTime(880, audioCtx.currentTime + 0.5);
        osc.frequency.linearRampToValueAtTime(440, audioCtx.currentTime + 1.0);
        gain.gain.setValueAtTime(volumeMultiplier, audioCtx.currentTime);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();

        const sirenInterval = setInterval(() => {
          if (audioCtx.state === "closed") {
            clearInterval(sirenInterval);
            return;
          }
          volumeMultiplier += 0.1;
          const o = audioCtx.createOscillator();
          const g = audioCtx.createGain();
          o.type = "sawtooth";
          o.frequency.setValueAtTime(440, audioCtx.currentTime);
          o.frequency.linearRampToValueAtTime(880, audioCtx.currentTime + 0.5);
          g.gain.setValueAtTime(volumeMultiplier, audioCtx.currentTime);
          o.connect(g);
          g.connect(audioCtx.destination);
          o.start();
          o.stop(audioCtx.currentTime + 0.5);
        }, 500);
      }

      document.addEventListener("click", (e) => {
        if (
          e.target.closest("button") &&
          e.target.id !== "crank-btn" &&
          e.target.innerText !== "VERIFY"
        ) {
          playClickSound();
        }
      });

      // === APP LOGIC ===
      const targetPhrase =
        "I will never do irony again in my whole 'VOET' life. From now on, ami ja bolibo shotto bolibo, shotto chara ar kichu bolibo na.";

      function checkSpelling(input) {
        const currentVal = input.value;
        const errorMsg = document.getElementById("error-msg");
        if (!targetPhrase.startsWith(currentVal)) {
          playErrorSound();
          input.value = "";
          errorMsg.style.display = "block";
          setTimeout(() => (errorMsg.style.display = "none"), 1000);
          input.classList.add("animate__animated", "animate__shakeX");
          setTimeout(
            () =>
              input.classList.remove("animate__animated", "animate__shakeX"),
            500,
          );
        }
      }

      function validateLayer2() {
        const input = document.getElementById("typing-challenge");
        const checkbox = document.getElementById("terms-check");
        if (input.value === targetPhrase && checkbox.checked) {
          goToLayer3();
        } else {
          playErrorSound();
          Swal.fire({
            icon: "error",
            title: "Warning!",
            text: "‡¶†‡¶ø‡¶ï‡¶Æ‡¶§‡ßã ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç Terms ‡¶è‡¶ï‡ßç‡¶∏‡ßá‡¶™‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®",
            background: "#222",
            color: "#fff",
          });
        }
      }

      // === CAPTCHA LOGIC ===
      const captchaImages = [
        {
          id: 1,
          type: "pillow",
          src: "https://loremflickr.com/200/200/pillow?lock=1",
        },
        {
          id: 2,
          type: "pillow",
          src: "https://loremflickr.com/200/200/pillow?lock=2",
        },
        {
          id: 3,
          type: "pillow",
          src: "https://loremflickr.com/200/200/cushion?lock=3",
        },
        {
          id: 4,
          type: "tech",
          src: "https://loremflickr.com/200/200/computer?lock=4",
        },
        {
          id: 5,
          type: "pillow",
          src: "https://loremflickr.com/200/200/bed?lock=5",
        },
        {
          id: 6,
          type: "tech",
          src: "https://loremflickr.com/200/200/car?lock=6",
        },
        {
          id: 7,
          type: "pillow",
          src: "https://loremflickr.com/200/200/sofa?lock=7",
        },
        {
          id: 8,
          type: "tech",
          src: "https://loremflickr.com/200/200/phone?lock=8",
        },
        {
          id: 9,
          type: "pillow",
          src: "https://loremflickr.com/200/200/pillow?lock=9",
        },
      ];

      function generateCaptcha() {
        const overlay = document.getElementById("captcha-overlay");
        const grid = document.getElementById("captcha-grid");
        overlay.style.display = "flex";
        grid.innerHTML = "";

        // Shuffle Images
        const shuffled = [...captchaImages].sort(() => 0.5 - Math.random());

        shuffled.forEach((img) => {
          const imgEl = document.createElement("img");
          imgEl.src = img.src;
          imgEl.className = "captcha-img";
          imgEl.dataset.type = img.type;
          imgEl.onclick = () => {
            playClickSound();
            imgEl.classList.toggle("selected");
          };
          grid.appendChild(imgEl);
        });
      }

      function verifyCaptcha() {
        const selected = document.querySelectorAll(".captcha-img.selected");
        let correctCount = 0;
        let wrongCount = 0;

        selected.forEach((img) => {
          if (img.dataset.type === "pillow") correctCount++;
          else wrongCount++;
        });

        // WIN CONDITION: 4 or more pillows AND less than 2 wrong clicks
        if (correctCount >= 3 && wrongCount < 3) {
          // SUCCESS
          document.getElementById("captcha-overlay").style.display = "none";

          // Show the hidden disable button
          document.getElementById("disable-btn-container").style.display =
            "block";
          document.getElementById("alarm-status-msg").style.display = "none";

          playClickSound();
        } else {
          // FAIL
          playErrorSound();
          alert("INCORRECT. FIND THE PILLOWS.");
          // Reshuffle for punishment
          generateCaptcha();
        }
      }

      // === CHEAT CODE SYSTEM (DESKTOP & MOBILE) ===

      // 1. THE SHARED CHEAT FUNCTION
      async function runCheatSequence() {
        const { value: code } = await Swal.fire({
          title: "CHEAT CODE",
          input: "password",
          inputLabel: "CODE ‡¶ü‡¶æ ‡¶¶‡¶ø‡¶®:",
          inputValue: "",
          inputAttributes: {
            autocomplete: "new-password",
            name: "cheat-code-" + Math.random(),
          },
          didOpen: () => {
            const input = Swal.getInput();
            if (input) input.value = "";
          },
          background: "#000",
          color: "#00ff41",
          confirmButtonColor: "#d33",
          confirmButtonText: "BYPASS",
        });

        if (code === "666") {
          playClickSound();
          goToLayer3(); // SUCCESS
        } else if (code) {
          playErrorSound();
          Swal.fire({
            icon: "error",
            title: "‡¶¨‡¶æ‡¶¨‡¶æ ‡¶è‡¶ï‡¶∂ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶¶‡¶æ‡¶ì",
            text: "Send Money to 01783267644 (Bkash/Nagad/Rocket) to get the correct code.",
            background: "#222",
            color: "#fff",
          });
        }
      }

      // 2. DESKTOP TRIGGER (Enter Key)
      document.addEventListener("keydown", function (e) {
        const layer2 = document.getElementById("layer-2");
        const isLayer2Active = layer2.classList.contains("active-layer");

        if (e.key === "Enter" && isLayer2Active) {
          e.preventDefault();
          runCheatSequence();
        }
      });

      // 3. MOBILE TRIGGER (Triple Tap on Title)
      // Users can tap the "‡¶Ö‡¶ô‡ßç‡¶ó‡ßÄ‡¶ï‡¶æ‡¶∞‡¶®‡¶æ‡¶Æ‡¶æ" text 3 times to open the menu
      let tapCount = 0;
      let tapTimer;
      const cheatTitle = document.querySelector("#layer-2 h3"); // Selects the header

      if (cheatTitle) {
        cheatTitle.addEventListener("click", (e) => {
          tapCount++;
          clearTimeout(tapTimer);

          // Reset tap count if they stop tapping for 500ms
          tapTimer = setTimeout(() => {
            tapCount = 0;
          }, 500);

          if (tapCount === 3) {
            tapCount = 0; // Reset
            runCheatSequence(); // Launch Cheat
          }
        });
      }

      function initAudioAndGo() {
        initAudio();
        document.getElementById("layer-1").classList.remove("active-layer");
        document.getElementById("layer-2").classList.add("active-layer");
      }

      function goToLayer3() {
        playClickSound();
        Swal.fire({
          title: "‡¶ö‡¶≤‡¶ø‡¶§‡ßá‡¶õ‡ßá ‡¶∏‡¶æ‡¶∞‡ßç‡¶ï‡¶æ‡¶∏...",
          timer: 1000,
          timerProgressBar: true,
          didOpen: () => Swal.showLoading(),
          background: "#222",
          color: "#fff",
        }).then(() => {
          document.getElementById("layer-2").classList.remove("active-layer");
          document.getElementById("layer-3").classList.add("active-layer");
          startBatteryDrain();
        });
      }

      // === GAME STATE ===
      let phase = 0;
      let buffer = 0;
      let finalValues = { hh: "--", mm: "--", ss: "--", ap: "--" };
      let isProcessing = false;
      let batteryLevel = 100;
      let battInterval;

      const ui = {
        hh: document.getElementById("seg-hh"),
        mm: document.getElementById("seg-mm"),
        ss: document.getElementById("seg-ss"),
        ap: document.getElementById("seg-ap"),
        buffer: document.getElementById("buffer-val"),
        status: document.getElementById("status-text"),
        loader: document.getElementById("loader"),
        card: document.getElementById("mainCard"),
      };
      const commitBtn = document.querySelector(
        'button[onclick="commitTransaction()"]',
      );
      const container = document.querySelector(".card-body");

      function chargeBattery() {
        playCrankSound();
        if (batteryLevel < 100) batteryLevel += 5;
        if (batteryLevel > 100) batteryLevel = 100;
        const btn = document.getElementById("crank-btn");
        btn.classList.add("crank-flash");
        setTimeout(() => btn.classList.remove("crank-flash"), 100);
      }

      function startBatteryDrain() {
        battInterval = setInterval(() => {
          batteryLevel -= 1;
          const bar = document.getElementById("battery-bar");
          bar.style.width = Math.max(0, batteryLevel) + "%";
          bar.innerText = Math.floor(Math.max(0, batteryLevel)) + "%";
          bar.className = "progress-bar";
          if (batteryLevel < 30) bar.classList.add("bg-danger");
          else if (batteryLevel < 60) bar.classList.add("bg-warning");
          else bar.classList.add("bg-success");
          if (batteryLevel <= 0) {
            clearInterval(battInterval);
            triggerBSOD();
          }
        }, 100);
      }

      function triggerBSOD() {
        playBSODSound();
        // 1. Hide Game
        document.getElementById("layer-3").classList.remove("active-layer");
        document.getElementById("phantom-cursor").style.display = "none";
        document.body.classList.remove("inverted-inputs");

        // 2. Show BSOD
        const bsodLayer = document.getElementById("bsod-layer");
        const bsodContent = document.getElementById("bsod-content");
        const lifelessText = document.getElementById("lifeless-text");
        const progressSpan = document.getElementById("bsod-progress");

        bsodLayer.classList.add("active-layer"); // Triggers flex display

        bsodContent.style.display = "block";
        lifelessText.style.display = "none";
        progressSpan.innerText = "0%";

        // 3. Counter
        let progress = 0;
        const duration = 15000;
        const intervalTime = 100;
        const increment = 100 / (duration / intervalTime);

        const timer = setInterval(() => {
          progress += increment;
          if (Math.random() > 0.7) progress -= increment * 0.5;

          if (progress >= 100) {
            progress = 100;
            clearInterval(timer);
            progressSpan.innerText = "100%";
            setTimeout(() => {
              bsodContent.style.display = "none";
              lifelessText.style.display = "block";
              playErrorSound();
              setTimeout(() => {
                location.reload();
              }, 3000);
            }, 1000);
          }
          progressSpan.innerText = Math.floor(progress) + "%";
        }, intervalTime);
      }

      function fullReset() {
        ui.card.classList.add("animate__shakeX");
        setTimeout(() => ui.card.classList.remove("animate__shakeX"), 1000);
        phase = 0;
        buffer = 0;
        finalValues = { hh: "--", mm: "--", ss: "--", ap: "--" };
        ui.buffer.innerText = "0";
        ui.status.innerText = "‡¶∏‡¶¨ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶ö‡ßç‡¶õ‡¶ø üòè...";
        resetButtonPosition();
        updateDisplay();
      }

      function requestInteger() {
        if (isProcessing) return;
        isProcessing = true;
        ui.loader.style.display = "flex";
        setTimeout(() => {
          let displayRoll = "";
          if (phase === 3) {
            const result = Math.random() < 0.5 ? "AM" : "PM";
            buffer = result;
            displayRoll = result;
          } else {
            let roll = Math.floor(Math.random() * 21) - 10;
            if (roll === 0) roll = 1;
            let temp = (typeof buffer === "number" ? buffer : 0) + roll;
            if (temp > 60 || temp < -60) {
              playErrorSound();
              buffer = 0;
              displayRoll = "ERR";
            } else {
              buffer = temp;
              displayRoll = (roll > 0 ? "+" : "") + roll;
            }
          }

          const deltaEl = document.getElementById("buffer-delta");
          deltaEl.innerText = displayRoll;
          if (typeof buffer === "number" && displayRoll.includes("-"))
            deltaEl.style.color = "#ff4d4d";
          else deltaEl.style.color = "#00ff41";

          deltaEl.classList.remove("delta-visible");
          void deltaEl.offsetWidth;
          deltaEl.classList.add("delta-visible");
          setTimeout(() => {
            deltaEl.classList.remove("delta-visible");
          }, 800);

          ui.buffer.innerText = buffer;
          ui.loader.style.display = "none";
          isProcessing = false;
        }, 300);
      }

      function resetButtonPosition() {
        commitBtn.style.top = "";
        commitBtn.style.left = "";
        commitBtn.classList.remove("btn-runaway", "btn-danger");
        commitBtn.classList.add("btn-primary", "btn-xl");
        commitBtn.innerHTML = "Commit";
      }

      function commitTransaction() {
        resetButtonPosition();
        if (isProcessing) return;
        let isValid = false;
        if (phase === 0 && buffer >= 1 && buffer <= 12) {
          finalValues.hh = buffer.toString().padStart(2, "0");
          isValid = true;
        } else if (phase === 1 && buffer >= 0 && buffer <= 59) {
          finalValues.mm = buffer.toString().padStart(2, "0");
          isValid = true;
        } else if (phase === 2 && buffer >= 0 && buffer <= 59) {
          finalValues.ss = buffer.toString().padStart(2, "0");
          isValid = true;
        } else if (phase === 3 && (buffer === "AM" || buffer === "PM")) {
          finalValues.ap = buffer;
          isValid = true;
        }

        if (isValid) {
          playClickSound();
          phase++;
          buffer = 0;
          ui.buffer.innerText = "WAITING...";
          updateDisplay();
          if (phase > 3) {
            Swal.fire({
              icon: "success",
              title: "ALARM SET",
              text: `${finalValues.hh}:${finalValues.mm}:${finalValues.ss} ${finalValues.ap}`,
              timer: 1500,
              showConfirmButton: false,
            }).then(() => activateSystemCountdown());
          } else {
            const t = [
              "Hours (‡¶ò‡¶®‡ßç‡¶ü‡¶æ)",
              "Minutes (‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü)",
              "Seconds (‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°)",
              "Meridiem (‡¶è‡¶è‡¶Æ/‡¶™‡¶ø‡¶è‡¶Æ)",
            ];
            ui.status.innerText = `Phase ${phase + 1}: ${t[phase]}...`;
          }
        } else {
          playErrorSound();
          Swal.fire({
            icon: "error",
            title: "‡¶∂‡¶ï‡ßç‡¶§‡¶ø ‡¶¶‡¶æ‡¶ì ‡¶¨‡¶ø‡¶ß‡¶æ‡¶§‡¶æ...",
            text: "‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶ï‡¶ø ‡¶ï‡¶ñ‡¶®‡ßã ‡¶ã‡¶£‡¶æ‡¶§‡ßç‡¶Æ‡¶ï ‡¶π‡¶Ø‡¶º?",
            background: "#222",
            color: "#fff",
          }).then(() => fullReset());
        }
      }

      function activateSystemCountdown() {
        clearInterval(battInterval);
        document.getElementById("controls-1").style.display = "none";
        document.getElementById("controls-2").style.display = "none";
        document.getElementById("power-section").style.display = "none";
        document.getElementById("countdown-panel").style.display = "block";
        ui.status.innerText = "‡¶∏‡¶¨ ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶™‡¶æ‡¶ö‡ßç‡¶õ‡¶ø üòè...";

        const now = new Date();
        const target = new Date();
        let h = parseInt(finalValues.hh);
        const m = parseInt(finalValues.mm);
        const s = parseInt(finalValues.ss);
        if (finalValues.ap === "PM" && h !== 12) h += 12;
        if (finalValues.ap === "AM" && h === 12) h = 0;
        target.setHours(h, m, s, 0);
        if (target < now) target.setDate(target.getDate() + 1);

        const alarmInterval = setInterval(() => {
          const currentTime = new Date();
          const diff = target - currentTime;
          if (diff <= 0) {
            clearInterval(alarmInterval);
            document.getElementById("countdown-display").innerText = "00:00:00";

            // 1. TRIGGER CHAOS
            playAlarmSound();
            document.body.style.animation = "violent-shake 0.2s infinite";
            document.querySelector(".card").style.animation = "none";

            // 2. SHOW CAPTCHA (Don't show disable button yet)
            generateCaptcha();
          } else {
            const hours = Math.floor((diff / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((diff / (1000 * 60)) % 60);
            const seconds = Math.floor((diff / 1000) % 60);
            document.getElementById("countdown-display").innerText = `${hours
              .toString()
              .padStart(2, "0")}:${minutes
              .toString()
              .padStart(2, "0")}:${seconds.toString().padStart(2, "0")}`;
          }
        }, 1000);
      }

      function updateDisplay() {
        ui.hh.innerText = finalValues.hh;
        ui.mm.innerText = finalValues.mm;
        ui.ss.innerText = finalValues.ss;
        ui.ap.innerText = finalValues.ap;
        ui.hh.className = phase === 0 ? "active-segment" : "";
        ui.mm.className = phase === 1 ? "active-segment" : "";
        ui.ss.className = phase === 2 ? "active-segment" : "";
        ui.ap.className = phase === 3 ? "active-segment" : "";
      }

      ["mouseover", "touchstart"].forEach((evt) =>
        commitBtn.addEventListener(evt, function (e) {
          if (Math.random() < 0.85) {
            playErrorSound();
            commitBtn.classList.add("btn-runaway", "btn-danger");
            commitBtn.classList.remove("btn-xl", "btn-primary");
            const maxX = container.clientWidth - 150;
            const maxY = container.clientHeight - 60;
            commitBtn.style.left =
              Math.max(0, Math.floor(Math.random() * maxX)) + "px";
            commitBtn.style.top =
              Math.max(0, Math.floor(Math.random() * maxY)) + "px";
            commitBtn.innerHTML = "Too Slow!";
          }
        }),
      );

      function triggerSuffering() {
        playErrorSound();
        Swal.fire({
          icon: "warning",
          title: "‡¶õ‡¶ø‡¶≤‡ßã ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Ø‡ßá ‡¶ï‡¶§ ‡¶∏‡ßç‡¶¨‡¶™‡ßç‡¶®...",
          showConfirmButton: false,
          timer: 1000,
        });
        document.body.classList.add("inverted-inputs");
        document.getElementById("phantom-cursor").style.display = "block";
      }

      const phantom = document.getElementById("phantom-cursor");
      document.addEventListener("mousemove", (e) => {
        if (!document.body.classList.contains("inverted-inputs")) return;
        phantom.style.transform = `translate(${
          window.innerWidth - e.clientX
        }px, ${window.innerHeight - e.clientY}px)`;
      });

      // === FOOTER DIGITAL CLOCK LOGIC ===
      function startFooterClock() {
        setInterval(() => {
          const now = new Date();
          let hours = now.getHours();
          const minutes = now.getMinutes().toString().padStart(2, "0");
          const seconds = now.getSeconds().toString().padStart(2, "0");
          const ampm = hours >= 12 ? "PM" : "AM";

          hours = hours % 12;
          hours = hours ? hours : 12; // hour '0' should be '12'

          const timeString = `${hours
            .toString()
            .padStart(2, "0")}:${minutes}:${seconds} ${ampm}`;
          document.getElementById("footer-digital-time").innerText = timeString;
        }, 1000);
      }
      startFooterClock();
      updateDisplay();
    </script>
  </body>
</html>
